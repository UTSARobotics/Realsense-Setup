services:
  # SERVICE 1: The Virtual Rover
  simulator:
    build: .
    container_name: coyote_sim
    network_mode: host  # Shares network with host for easiest UDP access
    environment:
      - MAVLINK20=1
    # Command to start ArduRover with 4-wheel skid steering
    command: >
      bash -c "cd /opt/ardupilot/Rover && 
      sim_vehicle.py -v Rover -f rover-skid --out=udp:127.0.0.1:14550 --no-mavproxy"

  # SERVICE 2: Your Python Code
  brain:
    build: .
    container_name: coyote_brain
    network_mode: host
    depends_on:
      - simulator
    volumes:
      - .:/workspace  # Live edit your code without rebuilding
    command: sleep infinity
